"use strict";(()=>{var a={};a.id=788,a.ids=[788],a.modules={1428:a=>{a.exports=import("axios")},1747:(a,b,c)=>{let d;c.d(b,{tU:()=>f,Ay:()=>e});let e=d=new(require("@prisma/client")).PrismaClient,f=async a=>d.mention.create({data:a})},3656:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>o,default:()=>n,handler:()=>m});var e=c(9046),f=c(8667),g=c(3480),h=c(6435),i=c(8154),j=c(8112),k=c(8766),l=a([i]);i=(l.then?(await l)():l)[0];let n=(0,h.M)(i,"default"),o=(0,h.M)(i,"config"),p=new g.PagesAPIRouteModule({definition:{kind:f.A.PAGES_API,page:"/api/collect-data",pathname:"/api/collect-data",bundlePath:"",filename:""},userland:i,distDir:".next",projectDir:""});async function m(a,b,c){let d=await p.prepare(a,b,{srcPage:"/api/collect-data"});if(!d){b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve());return}let{query:f,params:g,prerenderManifest:h}=d;try{let c=a.method||"GET",d=(0,j.getTracer)(),e=d.getActiveScopeSpan(),i=p.instrumentationOnRequestError.bind(p),l=async e=>p.render(a,b,{query:{...f,...g},params:g,allowedRevalidateHeaderKeys:void 0,multiZoneDraftMode:!0,trustHostHeader:void 0,previewProps:h.preview,propagateError:!1,dev:p.isDev,page:"/api/collect-data",projectDir:"",onError:(...b)=>i(a,...b)}).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let f=d.getRootSpanAttributes();if(!f)return;if(f.get("next.span_type")!==k.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${f.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let g=f.get("next.route");if(g){let a=`${c} ${g}`;e.setAttributes({"next.route":g,"http.route":g,"next.span_name":a}),e.updateName(a)}else e.updateName(`${c} ${a.url}`)});e?await l(e):await d.withPropagatedContext(a.headers,()=>d.trace(k.BaseServerSpan.handleRequest,{spanName:`${c} ${a.url}`,kind:j.SpanKind.SERVER,attributes:{"http.method":c,"http.target":a.url}},l))}catch(a){if(p.isDev)throw a;(0,e.sendError)(b,500,"Internal Server Error")}finally{null==c.waitUntil||c.waitUntil.call(c,Promise.resolve())}}d()}catch(a){d(a)}})},3672:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{l:()=>g});var e=c(1428),f=a([e]);e=(f.then?(await f)():f)[0];let h=process.env.MELTWATER_API_KEY;async function g(){try{return(await e.default.get("https://api.meltwater.com/v1/mentions",{headers:{Authorization:`Bearer ${h}`},params:{limit:100}})).data.mentions||[]}catch(a){return[]}}d()}catch(a){d(a)}})},5600:a=>{a.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7301:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{O:()=>h});var e=c(1428),f=a([e]);e=(f.then?(await f)():f)[0];let i=process.env.REDDIT_CLIENT_ID||"",j=process.env.REDDIT_SECRET||"",k="CoinbasePRBot/1.0";async function g(){return(await e.default.post("https://www.reddit.com/api/v1/access_token","grant_type=client_credentials",{auth:{username:i,password:j},headers:{"User-Agent":k}})).data.access_token}async function h(a="CryptoCurrency",b="Coinbase",c=100){try{let d=await g();return(await e.default.get(`https://oauth.reddit.com/r/${a}/search`,{headers:{Authorization:`Bearer ${d}`,"User-Agent":k},params:{q:b,limit:c,sort:"new",restrict_sr:1}})).data.data.children.map(a=>a.data)||[]}catch(a){return[]}}d()}catch(a){d(a)}})},8154:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>k});var e=c(3672),f=c(8786),g=c(9825),h=c(7301),i=c(1747),j=a([e,f,h]);async function k(a,b){try{let[a,c,d,j]=await Promise.all([(0,e.l)(),(0,f.V)(),(0,g.T)(),(0,h.O)()]),k=[...a.map(a=>({timestamp:new Date(a.published_at||a.timestamp||Date.now()),platform:"Meltwater",content:a.content||a.text,sentiment:"unknown",sentimentScore:0,reach:a.reach||0,authorHandle:a.author||a.author_handle||"",publication:a.publication||"",headline:a.headline||"",type:"news",topics:[],influencer:!1})),...c.map(a=>({timestamp:new Date(a.created_at),platform:"Twitter",content:a.text,sentiment:"unknown",sentimentScore:0,reach:a.public_metrics?.impression_count||0,authorHandle:a.author_id,publication:"",headline:"",type:"social",topics:[],influencer:!1})),...d.map(a=>({timestamp:new Date(a.pubDate||a.isoDate||Date.now()),platform:"Google News",content:a.contentSnippet||a.title,sentiment:"unknown",sentimentScore:0,reach:0,authorHandle:"",publication:a.source||a.creator||"",headline:a.title,type:"news",topics:[],influencer:!1})),...j.map(a=>({timestamp:new Date(1e3*(a.created_utc||Date.now())),platform:"Reddit",content:a.title+"\n"+(a.selftext||""),sentiment:"unknown",sentimentScore:0,reach:a.score||0,authorHandle:a.author,publication:"",headline:a.title,type:"community",topics:[],influencer:!1}))];for(let a of k)await (0,i.tU)(a);b.status(200).json({status:"success",count:k.length})}catch(a){b.status(500).json({status:"error",error:a.message})}}[e,f,h]=j.then?(await j)():j,d()}catch(a){d(a)}})},8786:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{V:()=>g});var e=c(1428),f=a([e]);e=(f.then?(await f)():f)[0];let h=process.env.TWITTER_BEARER_TOKEN;async function g(a="Coinbase",b=100){try{return(await e.default.get("https://api.twitter.com/2/tweets/search/recent",{headers:{Authorization:`Bearer ${h}`},params:{query:a,max_results:b,tweet_fields:"created_at,author_id,text,public_metrics"}})).data.data||[]}catch(a){return[]}}d()}catch(a){d(a)}})},9825:(a,b,c)=>{c.d(b,{T:()=>f});let d=require("rss-parser"),e=new(c.n(d)());async function f(){try{return(await e.parseURL("https://news.google.com/rss/search?q=Coinbase&hl=en-US&gl=US&ceid=US:en")).items||[]}catch(a){return[]}}}};var b=require("../../webpack-api-runtime.js");b.C(a);var c=b.X(0,[169],()=>b(b.s=3656));module.exports=c})();